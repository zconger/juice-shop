app:
  applicationId: ${JS_APP_ID:2bc22eb3-7a8d-4e0a-b2e2-2c3a5430ba4b}
  env: Cypress
  host: http://localhost:3000
  excludePaths:
    - ".*socket\\.io.*"
    - ".*\\.png"
    - ".*\\.jpeg"
    - ".*\\.jpg"
    - ".*\\.woff"
    - ".*\\.woff2"
    - ".*\\.ttf"
    - ".*\\.ico"
  authentication:
    external:
      type: COOKIE
      value: "token=${JS_AUTH_TOKEN}"
    cookieAuthorization:
      cookieNames:
        - token
    testPath:
      type: BODY
      path: /rest/user/whoami
      success: ".*email.*"
      requestMethod: GET
    loggedInIndicator: ".*"
    loggedOutIndicator: "^$"

hawk:
  spider:
    ajax: false
    base: false
    custom:
      command: 'bash'
      arguments:
        - "-c"
        - "npx cypress run || true"
      logOutputToForeground: true
      environment:
        NO_PROXY: "<-loopback>"

hawkAddOn:
  replacer:
    rules:
      - matchString: Authorization
        replaceOnly: false
        replacement: "Bearer ${JS_AUTH_TOKEN}"
